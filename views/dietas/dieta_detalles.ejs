
<%- include('../includes/head.ejs'); %>
<% if (rol == "Cliente") { %>
<% if (dietas.length > 0) { %>

<div class="container" style="margin-top: 20px;" >
  <form action="/dietas/id" method="POST">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>" >
  <div class="card">
    <header class="card-header" style="background-color: rgb(31, 134, 134);">
      <p class="card-header-title has-text-white-ter" style="font-size: 30px;" >
        <%= dietas[0].nombre%>
      </p>
    </header>
  </div>
  <div class="box has-background-black-ter">
    <table class="table has-background-black-ter" width="100%">
      <thead> <p class="subtitle is-4 has-text-white-ter">Alimentos </p></thead>
      <thead>
        <tr>
          <th class="has-text-white-ter">Nombre</th>
          <th class="has-text-white-ter">Medida</th>
          <th class="has-text-white-ter">Cantidad</th>
        </tr>
      </thead>
      <tbody class="has-text-white-ter">
        <% if (dieta_alimentos.length > 0) { %>
          <% for (let dieta_alimento of dieta_alimentos) { %>
            <tr>
            <td><%= dieta_alimento.nombre%></td>
            <td> <%= dieta_alimento.medida%></td>
            <td> <%= dieta_alimento.cantidad%></td>
          </tr>
            <% } %>
        <% } %>
      </tbody>
    </table>
    <div class="columns" >
      <div class="column" style="width: 50%; float:left;">
        <table class="table has-background-black-ter" style="width: 90%;">
          <thead>
            <tr>
              <th class="has-text-white-ter">MACRONUTRIENTES</th>
            </tr>
          </thead>
          <tbody>
            <% if (macronutriente.length > 0) { %>
              <% for (let macro of macronutriente) { %>
              <tr>
              <th class="has-text-white-ter">Calorias</th>
                <td class="has-text-white-ter"><%= macro.calorias%></td>
                <tr></tr>
                <th class="has-text-white-ter">Proteinas</th>
                <td class="has-text-white-ter"><%= macro.proteinas%></td>
                <tr></tr>
                <th class="has-text-white-ter">Carbohidratos</th>
                <td class="has-text-white-ter"> <%= macro.carbohidratos%></td>
                <tr></tr>
                <th class="has-text-white-ter">Grasas</th>
                <td class="has-text-white-ter">  <%= macro.grasas%></td>
              </tr>
                <% } %>
            <% } %>
          </tbody>
        </table>
        <br><br>
        <div class="buttons">
          <input class="button is-primary" type="button" value="Seleccionar Dieta" onclick="openPopup()">
          <div class="popup" id="popup">
            <h2 class="title is-4 has-text-white-ter">¿Seguro que quieres seleccionar la dieta de <%= dietas[0].nombre%>?</h2>
            <button class="button is-success" type = "submit">Confirmar</button>
            <button class="button is-danger" type="button" onclick="closePopup()">Cancelar</button>
          </div>
        </form>
        <script>
        let popup = document.getElementById("popup");
        function openPopup(){
          popup.classList.add("open-popup");
        }
        function closePopup(){
          popup.classList.remove("open-popup")
          }
          </script>
        </div>
        <% } %>
      </div>
      <div class="column" style="width: 50%; float: right; ">
        <div style="max-height: 300px; overflow: auto">
        <table class="table has-background-black-ter" style="width: 100%;">
          <thead>
            <tr>
              <th class="has-text-white-ter">MICRONUTRIENTES</th>
            </tr>
          </thead>
          <tbody>
            <% if (micronutriente.length > 0) { %>
              <% for (let micro of micronutriente) { %>
              <tr>
              <th class="has-text-white-ter">Ceniza</th>
                <td class="has-text-white-ter"><%= micro.ceniza%></td>
                <tr></tr>
                <th class="has-text-white-ter">Total de Fibra</th>
                <td class="has-text-white-ter"><%= micro.fibra_total%></td>
                <tr></tr>
                <th class="has-text-white-ter">Calcio</th>
                <td class="has-text-white-ter"> <%= micro.calcio%></td>
                <tr></tr>
                <th class="has-text-white-ter">Fosforo</th>
                <td class="has-text-white-ter"><%= micro.fosforo%></td>
                <tr></tr>
                <th class="has-text-white-ter">Hierro</th>
                <td class="has-text-white-ter"><%= micro.hierro%></td>
                <tr></tr>
                <th class="has-text-white-ter">Tiamina</th>
                <td class="has-text-white-ter"><%= micro.tiamina%></td>
                <tr></tr>
                <th class="has-text-white-ter">Riboflavina</th>
                <td class="has-text-white-ter"><%= micro.riboflavina%></td>
                <tr></tr>
                <th class="has-text-white-ter">Niacina</th>
                <td class="has-text-white-ter"> <%= micro.niacina%></td>
                <tr></tr>
                <th class="has-text-white-ter">Vitamina C</th>
                <td class="has-text-white-ter"><%= micro.vit_c%></td>
                <tr></tr>
                <th class="has-text-white-ter">Vitamina A</th>
                <td class="has-text-white-ter"><%= micro.vit_a%></td>
                <tr></tr>
                <th class="has-text-white-ter">Ácidos Grasos Mínimos</th>
                <td class="has-text-white-ter"> <%= micro.acgrasosmin%></td>
                <tr></tr>
                <th class="has-text-white-ter">Ácidos Grasos Poliinsaturados</th>
                <td class="has-text-white-ter"><%= micro.acgrasospoli%></td>
                <tr></tr>
                <th class="has-text-white-ter">Ácidos  Grasos Saturados</th>
                <td class="has-text-white-ter"><%= micro.acgrasossat%></td>
                <tr></tr>
                <th class="has-text-white-ter">Colesterol</th>
                <td class="has-text-white-ter"><%= micro.colesterol%></td>
                <tr></tr>
                <th class="has-text-white-ter">Potasio</th>
                <td class="has-text-white-ter"><%= micro.potasio%></td>
                <tr></tr>
                <th class="has-text-white-ter">Sodio</th>
                <td class="has-text-white-ter"><%= micro.sodio%></td>
                <tr></tr>
                <th class="has-text-white-ter">Zinc</th>
                <td class="has-text-white-ter"><%= micro.zinc%></td>
                <tr></tr>
                <th class="has-text-white-ter">Magnesio</th>
                <td class="has-text-white-ter"> <%= micro.magnesio%></td>
                <tr></tr>
                <th class="has-text-white-ter">Vitamina B6</th>
                <td class="has-text-white-ter"><%= micro.vit_b6%></td>
                <tr></tr>
                <th class="has-text-white-ter">Vitamina B12</th>
                <td class="has-text-white-ter"><%= micro.vit_b12%></td>
                <tr></tr>
                <th class="has-text-white-ter">Ácido Fólicos</th>
                <td class="has-text-white-ter"> <%= micro.acfolico%></td>
                <tr></tr>
                <th class="has-text-white-ter">Folato</th>
                <td class="has-text-white-ter"><%= micro.folatoeq%></td>
              </tr>
                <% } %>
            <% } %>
          </tbody>
        </table>
        </div>
      </div>
  </div>
  </form>
</div>


<% } else if (rol=="Administrador") { %>
  
<% if (dietas.length > 0) { %>

<div class="container" style="margin-top: 20px;" >
    <input type="hidden" name="_csrf" value="<%= csrfToken %>" >
  <div class="card">
    <header class="card-header" style="background-color: rgb(31, 134, 134);">
      <p class="card-header-title has-text-white-ter" style="font-size: 30px;" >
        <%= dietas[0].nombre%>
      </p>
    </header>
  </div>
  <div class="box has-background-black-ter">
    <table class="table has-background-black-ter" width="100%">
      <thead> <p class="subtitle is-4 has-text-white-ter">Alimentos </p></thead>
      <thead>
        <tr>
          <th class="has-text-white-ter">Nombre</th>
          <th class="has-text-white-ter">Medida</th>
          <th class="has-text-white-ter">Cantidad</th>
        </tr>
      </thead>
      <tbody class="has-text-white-ter">
        <% if (dieta_alimentos.length > 0) { %>
          <% for (let dieta_alimento of dieta_alimentos) { %>
            <tr>
            <td><%= dieta_alimento.nombre%></td>
            <td> <%= dieta_alimento.medida%></td>
            <td> <%= dieta_alimento.cantidad%></td>
          </tr>
            <% } %>
        <% } %>
      </tbody>
    </table>
    <div class="columns" >
      <div class="column" style="width: 50%; float:left;">
        <table class="table has-background-black-ter" style="width: 90%;">
          <thead>
            <tr>
              <th class="has-text-white-ter">MACRONUTRIENTES</th>
            </tr>
          </thead>
          <tbody>
            <% if (macronutriente.length > 0) { %>
              <% for (let macro of macronutriente) { %>
              <tr>
              <th class="has-text-white-ter">Calorias</th>
                <td class="has-text-white-ter"><%= macro.calorias%></td>
                <tr></tr>
                <th class="has-text-white-ter">Proteinas</th>
                <td class="has-text-white-ter"><%= macro.proteinas%></td>
                <tr></tr>
                <th class="has-text-white-ter">Carbohidratos</th>
                <td class="has-text-white-ter"> <%= macro.carbohidratos%></td>
                <tr></tr>
                <th class="has-text-white-ter">Grasas</th>
                <td class="has-text-white-ter">  <%= macro.grasas%></td>
              </tr>
                <% } %>
            <% } %>
          </tbody>
        </table>
        <br><br>
        <div class="field is-grouped">
        
        <% if (dietas.length > 0) { %>
          <% for (let dieta of dietas) { %>
            <div class="field is-grouped">
            </div>
          <% } %>
        <% } %>
        
        <form action="/dietas/eliminar" method="POST">
          <% if (dietas.length > 0){ %>
          <input class="button is-danger has-text-white-ter"style="position:relative; right: -70px" type="button" value="Eliminar dieta" onclick="openPopup()">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>" >
          <input type="hidden" name="id" value="id_dieta">
          <div class="popup" id="popup">
          <h2 class="title is-4 has-text-centered has-text-white-ter">¿Seguro que quieres eliminar esta dieta?</h2>
          <button class="button is-success" type = "submit">Confirmar</button>
          <button class="button is-danger" type="button" onclick="closePopup()">Cancelar</button>
          </div>
          </form>
          <% } %>
        </div>
        <% } %>
      </div>
      <div class="column" style="width: 50%; float: right; ">
        <div style="max-height: 300px; overflow: auto">
        <table class="table has-background-black-ter" style="width: 100%;">
          <thead>
            <tr>
              <th class="has-text-white-ter">MICRONUTRIENTES</th>
            </tr>
          </thead>
          <tbody>
            <% if (micronutriente.length > 0) { %>
              <% for (let micro of micronutriente) { %>
              <tr>
              <th class="has-text-white-ter">Ceniza</th>
                <td class="has-text-white-ter"><%= micro.ceniza%></td>
                <tr></tr>
                <th class="has-text-white-ter">Total de Fibra</th>
                <td class="has-text-white-ter"><%= micro.fibra_total%></td>
                <tr></tr>
                <th class="has-text-white-ter">Calcio</th>
                <td class="has-text-white-ter"> <%= micro.calcio%></td>
                <tr></tr>
                <th class="has-text-white-ter">Fosforo</th>
                <td class="has-text-white-ter"><%= micro.fosforo%></td>
                <tr></tr>
                <th class="has-text-white-ter">Hierro</th>
                <td class="has-text-white-ter"><%= micro.hierro%></td>
                <tr></tr>
                <th class="has-text-white-ter">Tiamina</th>
                <td class="has-text-white-ter"><%= micro.tiamina%></td>
                <tr></tr>
                <th class="has-text-white-ter">Riboflavina</th>
                <td class="has-text-white-ter"><%= micro.riboflavina%></td>
                <tr></tr>
                <th class="has-text-white-ter">Niacina</th>
                <td class="has-text-white-ter"> <%= micro.niacina%></td>
                <tr></tr>
                <th class="has-text-white-ter">Vitamina C</th>
                <td class="has-text-white-ter"><%= micro.vit_c%></td>
                <tr></tr>
                <th class="has-text-white-ter">Vitamina A</th>
                <td class="has-text-white-ter"><%= micro.vit_a%></td>
                <tr></tr>
                <th class="has-text-white-ter">Ácidos Grasos Mínimos</th>
                <td class="has-text-white-ter"> <%= micro.acgrasosmin%></td>
                <tr></tr>
                <th class="has-text-white-ter">Ácidos Grasos Poliinsaturados</th>
                <td class="has-text-white-ter"><%= micro.acgrasospoli%></td>
                <tr></tr>
                <th class="has-text-white-ter">Ácidos  Grasos Saturados</th>
                <td class="has-text-white-ter"><%= micro.acgrasossat%></td>
                <tr></tr>
                <th class="has-text-white-ter">Colesterol</th>
                <td class="has-text-white-ter"><%= micro.colesterol%></td>
                <tr></tr>
                <th class="has-text-white-ter">Potasio</th>
                <td class="has-text-white-ter"><%= micro.potasio%></td>
                <tr></tr>
                <th class="has-text-white-ter">Sodio</th>
                <td class="has-text-white-ter"><%= micro.sodio%></td>
                <tr></tr>
                <th class="has-text-white-ter">Zinc</th>
                <td class="has-text-white-ter"><%= micro.zinc%></td>
                <tr></tr>
                <th class="has-text-white-ter">Magnesio</th>
                <td class="has-text-white-ter"> <%= micro.magnesio%></td>
                <tr></tr>
                <th class="has-text-white-ter">Vitamina B6</th>
                <td class="has-text-white-ter"><%= micro.vit_b6%></td>
                <tr></tr>
                <th class="has-text-white-ter">Vitamina B12</th>
                <td class="has-text-white-ter"><%= micro.vit_b12%></td>
                <tr></tr>
                <th class="has-text-white-ter">Ácido Fólicos</th>
                <td class="has-text-white-ter"> <%= micro.acfolico%></td>
                <tr></tr>
                <th class="has-text-white-ter">Folato</th>
                <td class="has-text-white-ter"><%= micro.folatoeq%></td>
              </tr>
                <% } %>
            <% } %>
          </tbody>
        </table>
        </div>
      </div>
  </div>
  </form>
</div>

<script>
let popupp = document.getElementById("popup");
let noti = document.getElementById("notification");
let timeoutId;
function openPopup() {
popup.classList.add("open-popup");
}
function closePopup() {
popup.classList.remove("open-popup");
}
function showNotification() {
noti.classList.add("open-noti");
// Limpia el temporizador actual antes de configurar uno nuevo
clearTimeout(timeoutId);
// Reinicia el temporizador cada vez que se hace clic en el botón de eliminar
timeoutId = setTimeout(function () {
noti.classList.remove("open-noti");
document.querySelector(".notification").style.display = "none";
}, 4000);
}
</script>
<% } %>
<%- include('../includes/foot.ejs'); %>    