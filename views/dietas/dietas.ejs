<%- include('../includes/head.ejs'); %>
<% if (mensaje != '') { %>
    <div class="notification is-info is-light">
        <%= mensaje %>
    </div>
<% } %>
<h1 class = "title is-1 has-text-white-ter">Dietas Favoritas</h1>
<% if (dietasFav.length > 0) { %>
    <div class="columns">
        <% let columns = 0; %>
        <% for (let dietaFav of dietasFav) { %>
            <% if (columns % 4 == 0) { %>
    </div>
    <div class="columns">
            <% } %>
            <% columns++; %>
            <div class="column is-3">
                <div class="card">
                    <div class="card-image">
                        <div class="star">
                            <a> 
                                <svg version="1.2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="40" height="40">
                                    <defs>
                                        <image  width="20" height="20" id="img1" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUAQMAAAC3R49OAAAAAXNSR0IB2cksfwAAAANQTFRFAAAAp3o92gAAAAF0Uk5TAEDm2GYAAAAMSURBVHicY2CgLgAAAFAAAfMw9yoAAAAASUVORK5CYII="/>
                                    </defs>
                                    <style>
                                        .s0 { fill: #000000 } 
                                    </style>
                                    <use id="Background" href="#img1" x="0" y="0"/>
                                    <path id="Layer" fill-rule="evenodd" class="s0" d="m18.8 7.2h-5.5l-2.8-6.2c-0.2-0.5-1.1-0.5-1.4 0l-2.8 6.2h-5.5c-0.3 0-0.6 0.2-0.7 0.5-0.1 0.3 0 0.6 0.2 0.8l4.1 3.8-1.8 6.6c-0.1 0.3 0 0.6 0.3 0.8 0.2 0.2 0.6 0.2 0.8 0.1l6.1-3.5 6.1 3.5c0.1 0.1 0.2 0.1 0.4 0.1 0.2 0 0.3-0.1 0.5-0.2 0.2-0.2 0.3-0.5 0.3-0.8l-1.8-6.6 4.1-3.8c0.2-0.2 0.3-0.5 0.2-0.8-0.2-0.3-0.5-0.5-0.8-0.5z"/>
                                </svg>
                            </a>
                        </div>
                        <figure class="image is-4by3">
                            <a href="/dietas/<%= dietaFav.id_dieta %>"><img src="<%= dietaFav.Url_image %>"
                                    alt="Placeholder image"></a>
                        </figure>
                    </div>
                    <div class="card-content">
                        <div class="media">
                            <div class="media-left">
                                <figure class="image is-48x48">
                                    <img src="https://cdn-icons-png.flaticon.com/512/706/706133.png" alt="Placeholder image">
                                </figure>
                            </div>
                            <div class="media-content">
                                <p class="title is-4"><%= dietaFav.nombre %></p>
                                <p class="subtitle is-6">Calorías: <%= dietaFav.calorias.toFixed(2) %></p>
                            </div>
                        </div>
                    
                    </div>
                </div>
            </div>
        <% } %>
    </div>
    <% } %>
    <h1 class="title is-1 has-text-white-ter">Más Dietas</h1>
    <div>
    </div>
    <% if (dietas.length> 0) { %>
        <form action="/dietas" method="POST" autocomplete="off">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>" >
            <input type="hidden" name="id_dieta" id="id_dieta" value="">
        <div class="columns">
            <% columns=0; %>
                <% for (let dieta of dietas) { %>
                    <% if (columns % 4==0) { %>
        </div>
        <div class="columns">
            <% } %>
                <% columns++; %>
                    <div class="column is-3">
                        <div class="card" data-id="<%= dieta.id_dieta %>">
                            <div class="card-image">
                                <div class="star">
                                    <a onclick="openPopup('<%= dieta.id_dieta %>')"> 
                                    <svg version="1.2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="40" height="40">
                                        <defs>
                                            <image  width="20" height="20" id="img1" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUAQMAAAC3R49OAAAAAXNSR0IB2cksfwAAAANQTFRFAAAAp3o92gAAAAF0Uk5TAEDm2GYAAAAMSURBVHicY2CgLgAAAFAAAfMw9yoAAAAASUVORK5CYII="/>
                                        </defs>
                                        <style>
                                            .s0 { fill: #000000 } 
                                        </style>
                                        <use id="Background" href="#img1" x="0" y="0"/>
                                        <path id="Layer" fill-rule="evenodd" class="s0" d="m19.4 8.5l-4.1 3.8 1.8 6.6c0 0.3-0.1 0.6-0.3 0.8-0.2 0.1-0.3 0.2-0.5 0.2-0.2 0-0.3 0-0.4-0.1l-6.1-3.5-6.1 3.5c-0.2 0.1-0.6 0.1-0.8-0.1-0.3-0.2-0.4-0.5-0.3-0.8l1.8-6.6-4.1-3.8c-0.2-0.2-0.3-0.5-0.2-0.8 0.1-0.3 0.4-0.5 0.7-0.5h5.5l2.8-6.2c0.3-0.5 1.2-0.5 1.4 0l2.8 6.2h5.5c0.3 0 0.6 0.2 0.7 0.5 0.1 0.2 0 0.6-0.1 0.8zm-2.5 0.2h-4.1c-0.3 0-0.6-0.1-0.7-0.4l-2.3-5.1-2.3 5.1c-0.1 0.2-0.4 0.4-0.7 0.4h-4.1l3 2.8c0.2 0.1 0.3 0.4 0.2 0.7l-1.4 5.3 4.9-2.8c0.1-0.1 0.3-0.1 0.4-0.1 0.2 0 0.3 0 0.4 0.1l4.9 2.8-1.4-5.3c-0.1-0.2 0-0.5 0.2-0.7z"/>
                                    </svg>
                                    </a>
                                </div>
                                <figure class="image is-4by3">
                                    <a href="/dietas/<%= dieta.id_dieta %>"><img src="<%= dieta.Url_image %>"
                                            alt="Placeholder image"></a>
                                </figure>
                            </div>
                            <div class="card-content">
                                <div class="media">
                                    <div class="media-left">
                                        <figure class="image is-48x48">
                                            <img src="https://cdn-icons-png.flaticon.com/512/706/706133.png"
                                                alt="Placeholder image">
                                        </figure>
                                    </div>
                                    <div class="media-content">
                                        <p class="title is-4">
                                            <%= dieta.nombre %>
                                        </p>
                                        <p class="subtitle is-6">
                                            Calorías: <%= dieta.calorias.toFixed(2) %>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% } %>
        </div>
        <div class="popup" id="popup">
            <h2 class="title is-2">¿Quieres guardar esta dieta en Favoritos?</h2>
            <button class="button is-success" type = "submit">Sí</button>
            <button class="button is-danger" type="button" onclick="closePopup()">No</button>
        </div>
    </form>
        <% } else { %>
            <h1 class="has-text-white-ter">No hay dietas registradas</h1>
            <%}%>
<script>
    let popup = document.getElementById("popup");

    function openPopup(id){
        popup.classList.add("open-popup");
        document.getElementById("id_dieta").value = id;
    }

    function closePopup(){
        popup.classList.remove("open-popup")
    }
</script>
<%- include('../includes/foot.ejs'); %>